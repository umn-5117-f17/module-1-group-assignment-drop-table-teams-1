<!DOCTYPE html>
<html>
<head>
  <title>{{title}}</title>



  <link rel='stylesheet' href='/stylesheets/style.css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.5.3/css/bulma.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/stylesheets/viewer.min.css">

  <!-- Add the slick-theme.css if you want default styling -->
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/kenwheeler/slick@1.8.1/slick/slick.css"/>
<!-- Add the slick-theme.css if you want default styling -->
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/kenwheeler/slick@1.8.1/slick/slick-theme.css"/>

<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/south-street/jquery-ui.css" id="theme">
<link rel="stylesheet" href="//blueimp.github.io/Gallery/css/blueimp-gallery.min.css">



</head>
<body>
  <style>

    </style>
  <h1 style="text-align:center"> Hazelden's Field Guide to Life Data Visualization</h1>



<div class="columns">
  <div class="column is-two-fifths">



  <div class = "container">
    <button id="reset-zoom-button" >Reset</button>
    <button id="quiz-button">Take the Survey!</button>
    <button id="about-button">About the Project</button>
    <svg width="960" height="1000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  </svg>
  <div class="legend">   <text>TA = Total Actions;
      AD = Action Diversity;
     E = Engagment;
     DMV = Daily Message Views;
     IR = Time till Initial Relapse;
   </text></div>
</div>



</div>
  <div class="column">

  <p>
    How might we inform the addiction recovery community on how to improve the probability of a successful recovery? Substance addiction is a public health epidemic. This app aims to assist those suffering from substance addiction, so that they might better understand their demons.
    The visualizations below represents all sequences of event patterns following the reports of relapses between 1-10 days. The decision tree to the left is a recursive regression model that aims to predict probability of user relapse reports. Ten fold-cross validation shows the model is 84% accuracte.
    Visulization of temporal event sequences helps elucidate patterns for each distinct user group. Special thank you to the Human-Computer Interaction Lab at the University of Maryland for lending their EventFlow software.  <a href="http://hcil2.cs.umd.edu/trs/2013-11/2013-11.pdf"> Learn more about EventFlow.</a>
  </p>
      <!-- The dialog widget -->


<!-- <div id="blueimp-gallery-dialog" data-show="fade" data-hide="fade">

    <div class="blueimp-gallery blueimp-gallery-carousel blueimp-gallery-controls">
        <div class="slides"></div>
        <a class="prev">‹</a>
        <a class="next">›</a>
        <a class="play-pause"></a>
    </div>
</div> -->



</div>

</div>


<div class="image-slider">

  <div><h3>Group 3</h3><a  class="preview" title="Group 3" href="../images/group_3_window_2months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">

  <img src="../images/group_3_window_2months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
</a></div>

  <div><h3>Group 5</h3><a  class="preview" title="Group 5" href="../images/group_5_window_1months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">
    <img src="../images/group_5_window_1months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
    </a></div>

    <div><h3>Group 7</h3><a  class="preview" title="Group 7" href="../images/group_7_window_1month_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">
      <img src="../images/group_7_window_1month_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
      </a></div>

      <div><h3>Group 9</h3><a  class="preview" title="Group 9" href="../images/group_9_window_1month_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">
        <img src="../images/group_9_window_1month_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
        </a></div>

        <div><h3>Group 10</h3><a  class="preview" title="Group 10" href="../images/group_10_window_10months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">
          <img src="../images/group_10_window_10months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
          </a></div>

          <div><h3>Group 12</h3><a  class="preview" title="Group 12" href="../images/group_12_window_1Month_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">
            <img src="../images/group_12_window_1Month_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
            </a></div>

            <div><h3>Group 14</h3><a  class="preview" title="Group 14"  href="../images/group_14_window_24days_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">
              <img src="../images/group_14_window_24days_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
              </a></div>

              <div><h3>Group 15</h3><a  class="preview" title="Group 15" href="../images/group_15_window_4months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" height="300px" width="300px">
                <img src="../images/group_15_window_4months_after_alligned_on_all _1-10_ranked_records_following_descending_one_note.png" alt="blah" height="300px" width="300px">
                </a></div>
</div>

<!--<div class= "imageviewer">

      <img data-original="../images/group1_after_final_2months.png" src="../image_thumbs/out_group1_both_final_5months.png" alt="Picture 2">
      <img data-original="../images/group1_after_final_2months.png"  src="../image_thumbs/out_group1_both_final_5months.png" alt="Picture 3">

  </div>

  -->




<!--<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="http://d3js.org/d3.v4.min.js"/></script>
<script src="https://d3js.org/d3-zoom.v0.1.min.js"/></script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>


<script type="text/javascript" src="//cdn.jsdelivr.net/gh/kenwheeler/slick@1.8.1/slick/slick.min.js"></script>
<script src="./javascripts/local.js"/></script>
    <script type="text/javascript">


    var user_data = "{{ user_data }}"
    console.log("viz data pass: "+user_data);
    var commasplit = user_data.split(",");
    var kv_col = [];
    // var tmp;
    // var tmp2;
    // var tmp3;
    // for (var i = commasplit.length - 1; i >= 0; i--) {
    //
    //   tmp = commasplit[i].split(":")
    //   tmp2 = tmp[0].split(";");
    //   tmp3 = tmp2[1].split("&");
    //
    //   var key_val = [tmp3[0], tmp[1]];
    //
    //   kv_col.push(key_val);
    // }console.log(kv_col);

    var treeData ={"name": "1",
 "size":591,
"rule": "",
"parent": "null",
"value": 591,
"relapse": 0.2,
"type": "blue",
"level": "blue",
"left-label": "Less than 51% of the possible actions taken",
"right-label": "51%, oe more, of the possible actions taken",
"children": [
  {"name": "2",
       "size":459,
     "edge_label": "AD >= 51%",
     "parent": "null",
       "value": 459,
       "relapse": 0.16,
       "type": "blue",
       "level": "blue",
     "parent": "null",
     "rule": "Action.Diversity >= 0.510727969348659",
     "children": [
      {"name": "3",
       "size":189,
       "edge_label": " E >= 60%",
       "parent": "null",
        "value": 189,
             "relapse": 0.094,
             "type": "blue",
             "level": "blue",
           "parent": "null",
       "rule":"Action.Diversity >= 0.510727969348659 & Engagment >= 0.602983261002446"},
      {"name": "4",
       "size":270,
       "edge_label": " E < 60%",
           "parent": "null",
             "value": 270,
             "relapse": 0.21,
             "type": "blue",
             "level": "blue",
           "parent": "null",
       "rule": "Action.Diversity >= 0.510727969348659 & Engagment < 0.602983261002446",
       "children": [
        {"name": "5",
         "size":117,
         "edge_label": "DMV >= 50% TA",
               "parent": "null",
                 "value": 117,
                 "relapse": 0.15,
                 "type": "blue",
                 "level": "blue",
               "parent": "null",
           "rule":"Action.Diversity >= 0.510727969348659 & Engagment < 0.602983261002446 & daily.Message >= 0.501700680272109"},
           {"name": "6",
            "size":153,
         "edge_label": "DMV < 50% TA",
               "parent": "null",
                 "value": 153,
                 "relapse": 0.25,
                 "type": "blue",
                 "level": "blue",
               "parent": "null",
            "rule": "Action.Diversity >= 0.510727969348659 & Engagment < 0.602983261002446 & daily.Message < 0.501700680272109",
            "children": [
              {"name": "7",
               "size":93,
               "edge_label": " E >= 48%",
               "value":93,
               "relapse": 0.22,
                     "type": "blue",
                     "level": "blue",
               "rule":"Action.Diversity >= 0.510727969348659 & Engagment < 0.602983261002446 & daily.Message < 0.501700680272109 & Engagment >= 0.493492165932115"},
              {"name": "8",
               "size":60,
               "edge_label": " E < 48%",
               "value":60,
               "relapse": 0.3,
                     "type": "blue",
                     "level": "blue",
               "rule": "Action.Diversity >= 0.510727969348659 & Engagment < 0.602983261002446 & daily.Message < 0.501700680272109 & Engagment < 0.493492165932115",
               "children": [
                {"name": "9",
                 "size":45,
                 "edge_label": " E < 48%",
                   "value":45,
                   "relapse": 0.25,
                         "type": "blue",
                         "level": "blue",
                 "rule":"Action.Diversity >= 0.510727969348659 & Engagment < 0.602983261002446 & daily.Message < 0.501700680272109 & Engagment < 0.493492165932115 & Engagment < 0.476155287114846"},
                 {"name": "10",
                  "size":15,
                  "edge_label": " E >=  48%",
                   "value":15,
                   "relapse": 0.45,
                         "type": "blue",
                         "level": "blue",
                  "rule":"Action.Diversity >= 0.510727969348659 & Engagment < 0.602983261002446 & daily.Message < 0.501700680272109 & Engagment < 0.493492165932115 & Engagment >= 0.476155287114846"}
                ]}]}]}]},
     {"name": "11",
   "size":132,
   "rule": "Action.Diversity < 0.510727969348659",
   "edge_label": "AD < 51%",
   "parent": "null",
     "value": 132,
     "relapse": 0.35,
     "type": "blue",
     "level": "blue",
     "left-label": " Less than 88 minutes till first reported relapse",
     "right-label": "88 minutes, or longer, till first reported relapse",

     "children": [
        {"name": "12",
         "size":91,
         "edge_label": "IR >= 88 minutes",
           "parent": "null",
             "value": 91,
             "relapse": 0.29,
             "type": "blue",
             "level": "blue",
         "rule":"Action.Diversity < 0.510727969348659 & Interval.Init.Relapse >= 0.0612789351851852"},
        {"name": "13",
         "size":41,
         "edge_label": "IR < 88 minutes",
           "parent": "null",
             "value": 41,
             "relapse": 0.49,
             "type": "blue",
             "level": "blue",
         "rule": "Action.Diversity < 0.510727969348659 & Interval.Init.Relapse < 0.0612789351851852",

          "children": [
            {"name": "14",
             "size":19,
             "edge_label": "E >= 49%",
               "parent": "null",
                 "value": 19,
                 "relapse": 0.37,
                 "type": "blue",
                 "level": "blue",
             "rule":"Action.Diversity < 0.510727969348659 & Interval.Init.Relapse < 0.0612789351851852 & Engagment >= 0.492424242424242"},
            {"name": "15",
             "size":22,
             "edge_label":"E < 0.49",
             "value":22,
             "relapse": 0.6,
             "type": "blue",
             "level": "blue",
             "rule":"Action.Diversity < 0.510727969348659 & Interval.Init.Relapse < 0.0612789351851852 & Engagment < 0.492424242424242"}]}]}]}
      ;





      //d3.select("button").on("click", reset);
      createGraph(treeData,kv_col);




//       var fullscreenOptions = {
//     // Defines if the gallery should open in fullscreen mode:
//     fullScreen: true
// };
//       blueimp.Gallery([
//     {
//         title: 'Banana',
//         href: '../images/group1_after_final_2months.png',
//         type: 'image/png',
//         thumbnail: '../image_thumbs/out_group1_both_final_5months.png'
//     },
//     {
//         title: 'Apple',
//         href: '../images/group1_after_final_2months.png',
//         type: 'image/png',
//         thumbnail: '../image_thumbs/out_group1_both_final_5months.png'
//     },
//           //document.getElementById('links').getElementsByTagName('a'),
//           {
//               container: '#blueimp-gallery-carousel',
//               carousel: true,
//               fullScreen: true
//           }
//       ]);
  /*  document.getElementById('links').onclick = function (event) {
    event = event || window.event;
    var target = event.target || event.srcElement,
        link = target.src ? target.parentNode : target,
        options = {index: link, event: event},
        links = this.getElementsByTagName('a');
    blueimp.Gallery(links, options);
}; */
    /*  $(document).ready(function () {
      var images = document.getElementById('images');
      var viewer;
      console.log(images);
       //$("#modal").modal("toggle");
       console.log("render modal");
     });
    //  $('#modal').modal("show");

      $('#modal').on('shown.bs.modal', function (e) {
        if(e.namespace === 'bs.modal') {
        viewer = new Viewer(images, {
          url: 'data-original',
          toolbar: {
                    zoomIn: 4,
                    zoomOut: 4,
                    oneToOne: 4,
                    reset: 4,
                    prev: 4,
                    play: {
                      show: 4,
                      size: 'large',
                    },
                    next: 4,
                    rotateLeft: 4,
                    rotateRight: 4,
                    flipHorizontal: 4,
                    flipVertical: 4},

          ready: function () {
            viewer.show(true);},
            shown: function (){
              viewer.full(true);
              viewer.play(true);}
            }
          );
        }
      }).on('hidden.bs.modal', function (e) {
      if(e.namespace === 'bs.modal') {
        viewer.destroy();
      }
      });

      */




    </script>

  </body>
  </html>
